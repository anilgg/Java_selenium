package com.note;


import java.io.File;
import java.io.FileOutputStream;
import java.text.SimpleDateFormat;
import java.util.Date;

import jxl.write.DateFormat;

import org.apache.poi.hssf.usermodel.HSSFCell;
import org.apache.poi.hssf.usermodel.HSSFRow;
import org.apache.poi.hssf.usermodel.HSSFSheet;
import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.WebDriverWait;

public class timer {
	
	public static String sName = "TCResult";
	
	

	public static void main(String[] args) {
		String spath = "C:/Users/anigan/Downloads/AnilAnnaProject_"+dateTimePicker()+".xls";
		for(int i=0;i<100;i++){
			
			String startTime = dateTimePicker();
			System.out.println("Start time is: "+ startTime );
			WebDriver driver = new FirefoxDriver();
			driver.get("https://foundationia.alpha.live.qa.oceanwidebridge.com/Foundation.IAS.WebClient/Default.aspx");
			new WebDriverWait(driver, 10).until(ExpectedConditions.presenceOfElementLocated(By.xpath(".//*[@id='dvContent_4']/div[2]/table/tbody/tr[1]/td[3]")));
			String endTime = dateTimePicker();
			System.out.println("End time is: "+ endTime );
			String total = String.valueOf(Long.parseLong(endTime) - Long.parseLong(startTime));
			//		Double totalTime = (double) (Long.parseLong(endTime) - Long.parseLong(startTime));
			//		String total = String.valueOf(totalTime);
			System.out.println("Total Page Load Time: " + total+ "	seconds");
			//public static String[][] xData = new String[i+1][0]
					
			writeXL(spath, sName, xData[]);
			
		}
	}

	public static String dateTimePicker()
	{
		SimpleDateFormat dateFormat = new SimpleDateFormat("MMddyyyyHHmmss");
		Date date = new Date();
		String date1= dateFormat.format(date);
		return date1;
	}
	public static void writeXL(String sPath, String iSheet, String[][] xData1,String value)
			throws Exception{
				String[][] xData2 = {"",""},{"",""};
			    File outFile = new File(sPath);
			       HSSFWorkbook wb = new HSSFWorkbook();
			       HSSFSheet osheet = wb.createSheet(iSheet);
			       int xR_TS = xData.length;
			       int xC_TS = xData[0].length;
			    for (int myrow = 0; myrow < xR_TS; myrow++) {
			       HSSFRow row = osheet.createRow(myrow);
			       for (int mycol = 0; mycol < xC_TS; mycol++) {
			        HSSFCell cell = row.createCell(mycol);
			        cell.setCellType(HSSFCell.CELL_TYPE_STRING);
			        cell.setCellValue(value);
			        //cell.setCellValue(xData[myrow][mycol]);
			       }
			       FileOutputStream fOut = new FileOutputStream(outFile);
			       wb.write(fOut);
			       fOut.flush();
			       fOut.close();
			    }
			}


}


